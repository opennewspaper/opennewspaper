{* debug *}

{include file="mod3.css"} {* css for processin extras *}
{include file="mod3.js"}  {* js for extra processing extras *}

{if (!$IS_CONCRETE_ARTICLE)}
	<br />
	{* checkbox: show levels above for pagezone_page and default article *}
	<input type="checkbox" {if $SHOW_LEVELS_ABOVE}checked="checked" {/if} onchange="javascript:toggle_show_levels_above(this.checked);" /> {$LABEL.show_levels_above}<br /><br />
{/if}

{section name=i loop=$DATA}
<div style="margin-bottom: 7px;">
{* paragraph: use 0 (insert to top, when pagezone_type article is displayed), use false, when pagezone_page (no paragraph needed ...) *}

{* insert at top position, differs depending on type pagezone_page and article; icon for concrete article is set in mod3_pagezone_article.tmpl *}
{if (!$IS_CONCRETE_ARTICLE)}
	<a href="#" onclick="extra_insert_after(0, {$DATA[i].pagezone_id}, {if ($DATA[i].pagezone_type->getAttribute('is_article') == 1)}0{else}false{/if}, false, 0); return false;">{$NEW_TOP_ICON}</a> 
{/if}

	{foreach name=np_section item=s from=$DATA[i].section}{$s->getAttribute('section_name')}{if $smarty.foreach.np_section.last != 1}/{/if}{/foreach}
	
	{* Dropdown for page and page zone for last (=selected) section only (and if NOT concrete article) *}
	{if !$IS_CONCRETE_ARTICLE && $smarty.section.i.last} 
	 	&nbsp; &nbsp; 
		{$LABEL.pagetype}: 
		<select  onchange="page_type_change(this.value)">
		{section name="j loop=$PAGETYPE}
			{if $PAGETYPE[j]->getUid() == $DATA[i].page_type->getUid()}
				<option selected="selected" 
			{else}
				<option
			{/if} value="{$PAGETYPE[j]->getUid()}">{$PAGETYPE[j]->getAttribute('type_name')}</option> 
		{/section}
		</select>
		{if ($ADMIN)}
			[{$DATA[i].page_id}]
		{/if}
		 &nbsp; &nbsp; 
		{$LABEL.pagezonetype}: 
		<select  onchange="pagezone_type_change(this.value)">
		{section name="j loop=$PAGEZONETYPE}
			{if $PAGEZONETYPE[j]->getUid() == $DATA[i].pagezone_type->getUid()}
				<option selected="selected" 
			{else}
				<option
			{/if} value="{$PAGEZONETYPE[j]->getUid()}">{$PAGEZONETYPE[j]->getAttribute('type_name')}</option> 
		{/section}
		</select>
		{if ($ADMIN)}
			[{$DATA[i].pagezone_id}|{$DATA[i].pagezone_concrete_id}]
		{/if}
	{/if}
{if !$IS_CONCRETE_ARTICLE && $DATA[0].pagezone_type->getAttribute('is_article') == 0}
	{* dummy button for pagezone_page only *}
	&nbsp; &nbsp;<a href="javascript:extra_insert_after_dummy(0, {$DATA[i].pagezone_id});">{$DUMMY_ICON}</a> 
{/if}	
</div>

{if $PAGEZONE[i] != false || $IS_CONCRETE_ARTICLE}
	{* always render for concrete articles, even if empty because shortcuts for extras might be rendered *}
	{$PAGEZONE[i]} {* pagezones are rendered separately *}
{else}
	<div style="margin-bottom: 22px;">{$MESSAGE.pagezone_empty}</div>
{/if}
{/section}